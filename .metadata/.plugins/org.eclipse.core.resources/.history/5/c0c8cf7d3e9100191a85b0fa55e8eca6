package menusconiconos;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.GraphicsEnvironment;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.AbstractAction;
import javax.swing.ButtonGroup;
import javax.swing.JCheckBoxMenuItem;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;
import javax.swing.JPopupMenu;
import javax.swing.JRadioButtonMenuItem;
import javax.swing.JScrollPane;
import javax.swing.JTextPane;
import javax.swing.text.StyledEditorKit;

public class Lamina extends JPanel
{
	private static final long serialVersionUID = 1L;
	
	private String[] misFuentes = GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames();
	
	private JMenuBar mibarra;
	
	private ButtonGroup tamano, colores, fuentes;
	
	private JTextPane texto;
	
	private JPopupMenu emergente;
	
	private JScrollPane soporteTexto;
	
	private JMenu[] opciones = {new JMenu("Font"), new JMenu("Style"), new JMenu("Size"), new JMenu("Text color")};
	
	private JMenuItem[] fuente;
	
	private JMenuItem[] estilo = {new JCheckBoxMenuItem("Bold"), new JCheckBoxMenuItem("Italic")};
	
	private JMenuItem[] size = {new JRadioButtonMenuItem("12"), new JRadioButtonMenuItem("14"),  new JRadioButtonMenuItem("16"),  new JRadioButtonMenuItem("18"),  new JRadioButtonMenuItem("24"),  new JRadioButtonMenuItem("36")};
	
	private JMenuItem[] background = {anadirColores("Yellow", Color.yellow), anadirColores("Green", Color.green), anadirColores("Pink", Color.pink), anadirColores("Black", Color.black)};
	
	public Lamina() 
	{
		setLayout(new BorderLayout());
		
		anadirFuentes();
		
		JMenuItem[][] items = {fuente, estilo, size, background}; 
		
		anadirElementos(items);
		
		anadirAcciones(items);
		
		anadirAlGrupo(items, 0, fuentes);
		anadirAlGrupo(items, 2, tamano);
		anadirAlGrupo(items, 3, colores);
		
		this.add(mibarra, BorderLayout.NORTH);
		
		this.add(soporteTexto, BorderLayout.CENTER);
		
	}
	
	public void anadirFuentes() 
	{
		fuente = new JMenuItem[misFuentes.length - 235];
		
		for(int i = 0; i < misFuentes.length - 235; i++) 
			fuente[i] = new JRadioButtonMenuItem(misFuentes[i]);
		
	}
	
	public void anadirElementos(JMenuItem[][] items)
	{
		
		texto = new JTextPane();
		
		soporteTexto = new JScrollPane(texto);
		
		soporteTexto.setWheelScrollingEnabled(true);
		
		mibarra = new JMenuBar();
		
		emergente = new JPopupMenu();
		
		emergente.add(new JMenuItem(new AbstractAction() 
		{

			@Override
			public void actionPerformed(ActionEvent e) 
			{
				texto.setBackground(Color.blue);
				
			}

			
		}));
		
		texto.setComponentPopupMenu(emergente);
		
		for(int i = 0; i < items.length; i++) 
		{
			mibarra.add(opciones[i]);
			
			anadirItems(opciones[i], items[i]);
		}
			
	}
	
	public void anadirItems(JMenu opcion, JMenuItem[] items) 
	{
		for(JMenuItem I: items)
			opcion.add(I);
	}
	
	public void anadirAcciones(JMenuItem[][] items) 
	{
		
		for(JMenuItem F: fuente)
			F.addActionListener(new StyledEditorKit.FontFamilyAction("", F.getText()));
		
		for(JMenuItem S: size) 
		{
			S.addActionListener(new StyledEditorKit.FontSizeAction("", Integer.parseInt(S.getText())));
		}
			
		
		items[1][0].addActionListener(new StyledEditorKit.BoldAction());
		
		items[1][1].addActionListener(new StyledEditorKit.ItalicAction());
		
	}
	
	public void anadirAlGrupo(JMenuItem[][] items, int indice, ButtonGroup grupo) 
	{
		grupo = new ButtonGroup();
		
		for(JMenuItem M: items[indice])
			grupo.add(M);
	}
	
	public JRadioButtonMenuItem anadirColores(String titulo, Color color) 
	{
		JRadioButtonMenuItem etiqueta = new JRadioButtonMenuItem(titulo);
		
		etiqueta.addActionListener(new StyledEditorKit.ForegroundAction("", color));
		
		return etiqueta;
	}
	
}
